<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clashè½¬V2rayNèŠ‚ç‚¹å·¥å…·</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        body { background: #f5f5f5; color: #333; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db; }
        h2 { color: #34495e; margin: 15px 0; font-size: 18px; }
        .section { margin: 20px 0; }
        textarea { width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; height: 200px; resize: vertical; }
        button { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 5px; }
        button:hover { background: #2980b9; }
        button.secondary { background: #7f8c8d; }
        button.secondary:hover { background: #636e72; }
        button.success { background: #27ae60; }
        button.success:hover { background: #219653; }
        .result-box { background: #ecf0f1; padding: 15px; border-radius: 5px; margin-top: 15px; border-left: 4px solid #3498db; }
        .url-box { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 5px; border: 1px solid #dee2e6; word-break: break-all; }
        .step { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #2ecc71; }
        .info { background: #e3f2fd; padding: 10px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #2196f3; }
        .flex { display: flex; gap: 10px; flex-wrap: wrap; margin: 10px 0; }
        .config-item { background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 5px; border: 1px solid #e9ecef; }
        .config-item h3 { color: #2c3e50; margin-bottom: 5px; }
        .badge { background: #3498db; color: white; padding: 3px 8px; border-radius: 3px; font-size: 12px; margin-right: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ Clashé…ç½®è½¬V2rayNèŠ‚ç‚¹å·¥å…·</h1>
        
        <div class="info">
            <strong>ğŸ“Œ åŠŸèƒ½è¯´æ˜ï¼š</strong> å°†Clashé…ç½®æ–‡ä»¶è½¬æ¢ä¸ºV2rayNå¯å¯¼å…¥çš„èŠ‚ç‚¹é“¾æ¥
        </div>
        
        <div class="section">
            <h2>1. è¾“å…¥Clashé…ç½®</h2>
            <textarea id="clashConfig" placeholder="ç²˜è´´æ‚¨çš„Clashé…ç½®æ–‡ä»¶å†…å®¹...">log-level: debug
tun:
  enable: true
  device-id: fd://5
mode: rule
proxies:
- name: proxy
  type: vless
  server: n1761184189.74qxv.top
  port: 443
  udp: true
  uuid: b2d6c4f1-ddb8-4a2b-935a-d04787e8457c
  skip-cert-verify: false
  tls: true
  ws-opts:
    path: /b2d6c4f1-ddb8-4a2b-935a-d04787e8457c
    headers:
      Host: n1761184189.74qxv.top
  network: ws
mmdb: Country.mmdb</textarea>
        </div>
        
        <div class="flex">
            <button onclick="convertToV2rayN()">ğŸ”§ è½¬æ¢ä¸ºV2rayNèŠ‚ç‚¹</button>
            <button onclick="clearAll()" class="secondary">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰</button>
            <button onclick="addMoreProxies()" class="secondary">â• æ·»åŠ å¤šä¸ªä»£ç†ç¤ºä¾‹</button>
        </div>
        
        <div class="section" id="resultSection" style="display:none;">
            <h2>2. è½¬æ¢ç»“æœ</h2>
            <div id="resultBox" class="result-box"></div>
            <div class="flex">
                <button onclick="copyAllLinks()" class="success">ğŸ“‹ å¤åˆ¶æ‰€æœ‰èŠ‚ç‚¹é“¾æ¥</button>
                <button onclick="copySingeLink()" class="success">ğŸ“‹ å¤åˆ¶å•èŠ‚ç‚¹é“¾æ¥</button>
                <button onclick="exportAsFile()" class="secondary">ğŸ’¾ å¯¼å‡ºä¸ºtxtæ–‡ä»¶</button>
            </div>
        </div>
        
        <div class="section">
            <h2>3. ä½¿ç”¨è¯´æ˜</h2>
            <div class="step">
                <strong>ç¬¬ä¸€æ­¥ï¼š</strong> å°†Clashé…ç½®ç²˜è´´åˆ°ä¸Šæ–¹è¾“å…¥æ¡†
            </div>
            <div class="step">
                <strong>ç¬¬äºŒæ­¥ï¼š</strong> ç‚¹å‡»"è½¬æ¢ä¸ºV2rayNèŠ‚ç‚¹"æŒ‰é’®
            </div>
            <div class="step">
                <strong>ç¬¬ä¸‰æ­¥ï¼š</strong> å¤åˆ¶ç”Ÿæˆçš„èŠ‚ç‚¹é“¾æ¥
            </div>
            <div class="step">
                <strong>ç¬¬å››æ­¥ï¼š</strong> åœ¨V2rayNä¸­ç‚¹å‡»"ä»å‰ªè´´æ¿å¯¼å…¥URL"
            </div>
        </div>
        
        <div class="section">
            <h2>4. æ”¯æŒçš„åè®®</h2>
            <div class="flex">
                <div class="badge">VLESS</div>
                <div class="badge">VMess</div>
                <div class="badge">Trojan</div>
                <div class="badge">Shadowsocks</div>
                <div class="badge">HTTP/HTTPS</div>
                <div class="badge">Socks5</div>
            </div>
        </div>
    </div>

    <script>
        // è½¬æ¢å‡½æ•°
        function convertToV2rayN() {
            const input = document.getElementById('clashConfig').value.trim();
            if (!input) {
                alert('è¯·å…ˆè¾“å…¥Clashé…ç½®');
                return;
            }
            
            const resultBox = document.getElementById('resultBox');
            resultBox.innerHTML = '';
            
            try {
                // è§£æé…ç½®
                const lines = input.split('\n');
                let currentProxy = null;
                const proxies = [];
                let inProxiesSection = false;
                let indentLevel = 0;
                
                for (let line of lines) {
                    const trimmed = line.trim();
                    if (!trimmed) continue;
                    
                    // æ£€æµ‹proxieséƒ¨åˆ†å¼€å§‹
                    if (trimmed.startsWith('proxies:')) {
                        inProxiesSection = true;
                        continue;
                    }
                    
                    // å¦‚æœåœ¨proxieséƒ¨åˆ†å†…
                    if (inProxiesSection) {
                        // æ£€æµ‹æ–°çš„ä»£ç†å¼€å§‹
                        if (trimmed.startsWith('- name:')) {
                            if (currentProxy) proxies.push(currentProxy);
                            currentProxy = { type: '', server: '', port: '', name: '', uuid: '', path: '', host: '' };
                            currentProxy.name = trimmed.split('name:')[1].trim();
                        } 
                        // è§£æä»£ç†å±æ€§
                        else if (currentProxy) {
                            if (trimmed.startsWith('type:')) currentProxy.type = trimmed.split('type:')[1].trim();
                            if (trimmed.startsWith('server:')) currentProxy.server = trimmed.split('server:')[1].trim();
                            if (trimmed.startsWith('port:')) currentProxy.port = trimmed.split('port:')[1].trim();
                            if (trimmed.startsWith('uuid:')) currentProxy.uuid = trimmed.split('uuid:')[1].trim();
                            if (trimmed.includes('path:')) {
                                const match = trimmed.match(/path:\s*(.+)/);
                                if (match) currentProxy.path = match[1].trim();
                            }
                            if (trimmed.includes('Host:')) {
                                const match = trimmed.match(/Host:\s*(.+)/);
                                if (match) currentProxy.host = match[1].trim();
                            }
                        }
                    }
                }
                
                // æ·»åŠ æœ€åä¸€ä¸ªä»£ç†
                if (currentProxy) proxies.push(currentProxy);
                
                // ç”ŸæˆV2rayNé“¾æ¥
                let allLinks = [];
                proxies.forEach((proxy, index) => {
                    if (proxy.type && proxy.server && proxy.port) {
                        let v2rayNLink = '';
                        
                        // æ ¹æ®åè®®ç±»å‹ç”Ÿæˆé“¾æ¥
                        if (proxy.type.toLowerCase() === 'vless') {
                            v2rayNLink = generateVLESSLink(proxy);
                        } else if (proxy.type.toLowerCase() === 'vmess') {
                            v2rayNLink = generateVMessLink(proxy);
                        } else if (proxy.type.toLowerCase() === 'trojan') {
                            v2rayNLink = generateTrojanLink(proxy);
                        } else if (proxy.type.toLowerCase() === 'ss' || proxy.type.toLowerCase() === 'shadowsocks') {
                            v2rayNLink = generateSSLink(proxy);
                        } else {
                            v2rayNLink = `# ä¸æ”¯æŒçš„ç±»å‹: ${proxy.type}`;
                        }
                        
                        allLinks.push(v2rayNLink);
                        
                        // æ·»åŠ åˆ°ç»“æœæ¡†
                        const item = document.createElement('div');
                        item.className = 'config-item';
                        item.innerHTML = `
                            <h3><span class="badge">${proxy.type.toUpperCase()}</span> ${proxy.name || 'æœªå‘½åèŠ‚ç‚¹'}</h3>
                            <div class="url-box">${v2rayNLink}</div>
                            <button onclick="copyLink('${encodeURIComponent(v2rayNLink)}')" style="font-size:14px;padding:5px 10px;">ğŸ“‹ å¤åˆ¶æ­¤é“¾æ¥</button>
                        `;
                        resultBox.appendChild(item);
                    }
                });
                
                if (allLinks.length > 0) {
                    // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                    document.getElementById('resultSection').style.display = 'block';
                    
                    // ä¿å­˜åˆ°å…¨å±€å˜é‡
                    window.allLinks = allLinks;
                    
                    // æ·»åŠ æ‰¹é‡æ“ä½œ
                    const batchDiv = document.createElement('div');
                    batchDiv.innerHTML = `<p><strong>å·²ç”Ÿæˆ ${allLinks.length} ä¸ªèŠ‚ç‚¹é“¾æ¥</strong></p>`;
                    resultBox.insertBefore(batchDiv, resultBox.firstChild);
                    
                } else {
                    resultBox.innerHTML = '<div class="info">æœªæ‰¾åˆ°æœ‰æ•ˆçš„ä»£ç†é…ç½®</div>';
                    document.getElementById('resultSection').style.display = 'block';
                }
                
            } catch (error) {
                resultBox.innerHTML = `<div class="info">è½¬æ¢å‡ºé”™: ${error.message}</div>`;
                document.getElementById('resultSection').style.display = 'block';
            }
        }
        
        // ç”ŸæˆVLESSé“¾æ¥
        function generateVLESSLink(proxy) {
            let link = `vless://${proxy.uuid}@${proxy.server}:${proxy.port}`;
            let params = [];
            
            if (proxy.host) params.push(`host=${encodeURIComponent(proxy.host)}`);
            if (proxy.path) params.push(`path=${encodeURIComponent(proxy.path)}`);
            
            params.push('type=ws');
            params.push('security=tls');
            
            if (params.length > 0) {
                link += `?${params.join('&')}`;
            }
            
            if (proxy.name) {
                link += `#${encodeURIComponent(proxy.name)}`;
            }
            
            return link;
        }
        
        // ç”ŸæˆVMessé“¾æ¥
        function generateVMessLink(proxy) {
            const vmessConfig = {
                v: "2",
                ps: proxy.name || "",
                add: proxy.server,
                port: proxy.port,
                id: proxy.uuid || "",
                aid: "0",
                scy: "auto",
                net: "ws",
                type: "none",
                host: proxy.host || "",
                path: proxy.path || "/",
                tls: "tls",
                sni: proxy.host || ""
            };
            
            const jsonStr = JSON.stringify(vmessConfig);
            const base64Str = btoa(unescape(encodeURIComponent(jsonStr)));
            return `vmess://${base64Str}`;
        }
        
        // ç”ŸæˆTrojané“¾æ¥
        function generateTrojanLink(proxy) {
            return `trojan://${proxy.uuid}@${proxy.server}:${proxy.port}#${encodeURIComponent(proxy.name || 'TrojanèŠ‚ç‚¹')}`;
        }
        
        // ç”ŸæˆSSé“¾æ¥
        function generateSSLink(proxy) {
            // ç®€å•ç¤ºä¾‹ï¼Œå®é™…éœ€è¦æ›´å¤šå‚æ•°
            return `ss://${btoa('aes-256-gcm:' + (proxy.uuid || 'password'))}@${proxy.server}:${proxy.port}#${encodeURIComponent(proxy.name || 'SSèŠ‚ç‚¹')}`;
        }
        
        // å¤åˆ¶å•ä¸ªé“¾æ¥
        function copyLink(encodedLink) {
            const link = decodeURIComponent(encodedLink);
            navigator.clipboard.writeText(link).then(() => {
                alert('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            });
        }
        
        // å¤åˆ¶æ‰€æœ‰é“¾æ¥
        function copyAllLinks() {
            if (window.allLinks && window.allLinks.length > 0) {
                const allLinksText = window.allLinks.join('\n');
                navigator.clipboard.writeText(allLinksText).then(() => {
                    alert(`å·²å¤åˆ¶ ${window.allLinks.length} ä¸ªèŠ‚ç‚¹é“¾æ¥åˆ°å‰ªè´´æ¿`);
                });
            } else {
                alert('è¯·å…ˆè½¬æ¢é…ç½®');
            }
        }
        
        // å¤åˆ¶å•ä¸ªèŠ‚ç‚¹é“¾æ¥ï¼ˆç¬¬ä¸€ä¸ªï¼‰
        function copySingeLink() {
            if (window.allLinks && window.allLinks.length > 0) {
                navigator.clipboard.writeText(window.allLinks[0]).then(() => {
                    alert('å•èŠ‚ç‚¹é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                });
            } else {
                alert('è¯·å…ˆè½¬æ¢é…ç½®');
            }
        }
        
        // å¯¼å‡ºä¸ºæ–‡ä»¶
        function exportAsFile() {
            if (window.allLinks && window.allLinks.length > 0) {
                const content = window.allLinks.join('\n');
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'v2ray_nodes.txt';
                a.click();
                URL.revokeObjectURL(url);
            } else {
                alert('è¯·å…ˆè½¬æ¢é…ç½®');
            }
        }
        
        // æ¸…ç©ºæ‰€æœ‰
        function clearAll() {
            document.getElementById('clashConfig').value = '';
            document.getElementById('resultBox').innerHTML = '';
            document.getElementById('resultSection').style.display = 'none';
            window.allLinks = [];
        }
        
        // æ·»åŠ å¤šä¸ªä»£ç†ç¤ºä¾‹
        function addMoreProxies() {
            const example = `proxies:
# VLESSèŠ‚ç‚¹
- name: "VLESSèŠ‚ç‚¹1"
  type: vless
  server: server1.example.com
  port: 443
  uuid: b2d6c4f1-ddb8-4a2b-935a-d04787e8457c
  network: ws
  tls: true
  ws-opts:
    path: /path
    headers:
      Host: server1.example.com

# VMessèŠ‚ç‚¹  
- name: "VMessèŠ‚ç‚¹1"
  type: vmess
  server: server2.example.com
  port: 443
  uuid: 12345678-1234-1234-1234-123456789012
  alterId: 0
  cipher: auto
  network: ws
  tls: true
  ws-opts:
    path: /vmess
    headers:
      Host: server2.example.com

# TrojanèŠ‚ç‚¹
- name: "TrojanèŠ‚ç‚¹1"
  type: trojan
  server: server3.example.com
  port: 443
  password: password123
  sni: server3.example.com`;
            
            document.getElementById('clashConfig').value = example;
        }
    </script>
</body>
</html>